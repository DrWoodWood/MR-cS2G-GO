**# 4. Linkage disequilibrium score (LDSC) analysis, partioned heritability and single-SNP mendelian randomization (SSMR)**



**# 4.1 Using terminal** 

**#Using Python**

git clone https://github.com/bulik/ldsc.git

cd ldsc

conda env create --file environment.yml 

source activate ldsc

conda install scipy



**# LDSC** 

**# Preparing LDSC files of POAG and IS**

&nbsp;./munge\_sumstats.py \\

--signed-sumstats BETA,0 \\

--out poag \\

--a1 A1 \\

--a2 A2 \\

--snp snpid \\

--merge-alleles LDSCORE\_w\_hm3.snplist \\

--sumstats ./poag\_ldsc.txt 



./munge\_sumstats.py \\

--signed-sumstats BETA,0 \\

--out is \\

--a1 A1 \\

--a2 A2 \\

--snp snpid \\

--merge-alleles LDSCORE\_w\_hm3.snplist \\

--sumstats ./is\_ldsc.txt 



**# Calculating the genetic correlation between POAG and IS** 

./ldsc.py \\

--rg poag.sumstats.gz,is.sumstats.gz \\

--ref-ld-chr 1000G\_Phase3\_baselineLD\_v2.2\_ldscores/baselineLD.@ \\

--w-ld-chr weights/weights.hm3\_noMHC.@ \\

--out poag\_is\_correlation



**# Evaluating the partitioned heritability of POAG** 

./ldsc.py \\

--h2 poag.sumstats.gz \\

--ref-ld-chr ./1000G\_Phase3\_baselineLD\_v2.2\_ldscores/baselineLD. \\

--out partition\_poag \\

--overlap-annot  \\

--frqfile-chr ./1000G\_Phase3\_frq/1000G.EUR.QC. \\

--w-ld-chr ./weights/weights.hm3\_noMHC. \\

--print-coefficients 



**# Evaluating the partitioned heritability of IS** 

./ldsc.py \\

--h2 is.sumstats.gz \\

--ref-ld-chr ./1000G\_Phase3\_baselineLD\_v2.2\_ldscores/baselineLD. \\

--out partition\_is \\

--overlap-annot  \\

--frqfile-chr ./1000G\_Phase3\_frq/1000G.EUR.QC. \\

--w-ld-chr ./weights/weights.hm3\_noMHC. \\

--print-coefficients 



**# 4.2 Drawing the the partitioned heritability histogramwith R** 

library(tidyverse)

library(data.table)

library(ggplot)



poag\_ldsc<-fread('./ldsc/partition\_poag.results.txt',header = TRUE)

is\_ldsc<-fread('./ldsc/partition\_is.results.txt',header = TRUE)



poag\_ldsc %>% mutate(Category = str\_remove(Category, "\_0")) %>% 

&nbsp;    ggplot(., aes(x=Category, y=-log10(Enrichment\_p))) +

&nbsp;    geom\_hline(yintercept=-log10(0.05/nrow(poag\_ldsc)),linetype=2) +

&nbsp;    geom\_bar(stat = "identity",position = "dodge") +

&nbsp;    theme(axis.text.x = element\_text(angle = 90, vjust = 0.5, hjust=1)) + 

&nbsp;    ggtitle("Enrichment of different categories") +

&nbsp;    ylab("-log10(p)") + xlab("Category") +

&nbsp;    coord\_flip() 



is\_ldsc %>% mutate(Category = str\_remove(Category, "\_0")) %>% 

&nbsp;    ggplot(., aes(x=Category, y=-log10(Enrichment\_p))) +

&nbsp;    geom\_hline(yintercept=-log10(0.05/nrow(is\_ldsc)),linetype=2) +

&nbsp;    geom\_bar(stat = "identity",position = "dodge") +

&nbsp;    theme(axis.text.x = element\_text(angle = 90, vjust = 0.5, hjust=1)) + 

&nbsp;    ggtitle("Enrichment of different categories") +

&nbsp;    ylab("-log10(p)") + xlab("Category") +

&nbsp;    coord\_flip() 





