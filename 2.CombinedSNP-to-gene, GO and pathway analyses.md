**#2. Significant SNPs mapped to genes with combined SNP-to-gene (cS2G) method, single-gene mendelian randomization, gene ontology (GO) and pathway analyses**  

library(TwoSampleMR)

library(MendelianRandomization)

library(data.table)

library(stringr)



**#2.1 download allsnps.txt.gz, cS2G\_UKBB.zip and cS2G\_1000GEUR.zip files from #¡°https://zenodo.org/record/7754032¡±**



**# import cS2G\_1000GEUR data** 

a=list.files('./cS2G\_1000GEUR')

dir = paste("./cS2G\_1000GEUR/",a,sep="")

n=length(dir)

merge.data =fread(file = dir\[1])

merge.data$name<-c(rep(a\[1],length(rownames(merge.data))))

for (i in 2:n){

&nbsp;         new.data = fread(file = dir\[i])

&nbsp;         new.data$name<-c(rep(a\[i],length(rownames(new.data))))

&nbsp;         merge.data = rbind(merge.data,new.data)

&nbsp;     }

snp<-fread('./allsnps.txt.gz',header = FALSE)

merge.data$chr<-snp\[match(merge.data$SNP,snp$V1),'V2']

merge.data$pos<-snp\[match(merge.data$SNP,snp$V1),'V3']



**# import cS2G\_UKBB data** 

a1=list.files('./cS2G\_UKBB')

dir1 = paste("./cS2G\_UKBB/",a,sep="")

n=length(dir1)

merge.data1 =fread(file = dir1\[1])

merge.data1$name<-c(rep(a1\[1],length(rownames(merge.data1))))

for (i in 2:n){

&nbsp;         new.data = fread(file = dir1\[i])

&nbsp;         new.data$name<-c(rep(a1\[i],length(rownames(new.data))))

&nbsp;         merge.data1 = rbind(merge.data1,new.data)

&nbsp;     }



snp<-fread('./allsnps\_ukbb.txt.gz',header = FALSE)



merge.data1$chr<-snp\[match(merge.data1$SNP,snp$V1),'V2']

merge.data1$pos<-snp\[match(merge.data1$SNP,snp$V1),'V3']



merge.data1$chr1<-substr(merge.data1$SNP,1,str\_locate(merge.data1$SNP,':')-1)

merge.data1$pos1<-substr(merge.data1$SNP,str\_locate(merge.data1$SNP,':')+1,str\_locate(merge.data1$SNP,'\_')-1)

merge.data1\[which(is.na(merge.data1$chr))]$chr<-merge.data1\[which(is.na(merge.data1$chr))]$'chr1'

merge.data1\[which(is.na(merge.data1$pos))]$pos<-merge.data1\[which(is.na(merge.data1$pos))]$'pos1'



**#2.2 significant POAG SNPs mapped to genes**

poag<-extract\_instruments('finn-b-H7\_GLAUCPRIMOPEN',p1=5e-8,clump = FALSE,p2=1)

poag\_r1<-merge(poag,merge.data,by.x = c('chr.exposure','pos.exposure'),by.y = c('chr','pos'))

poag\_r2<-merge(poag,merge.data1,by.x = c('chr.exposure','pos.exposure'),by.y = c('chr','pos'))

poag\_r1<-data.frame(poag\_r1)

poag\_r2<-data.frame(poag\_r2)

poag\_r1<-poag\_r1\[,-c(16,17)]

colnames(poag\_r1)\[8]<-'SNP'

poag\_r1$samplesize.exposure<-c(rep(214634,length(rownames(poag\_r1))))

poag\_r2$samplesize.exposure<-c(rep(214634,length(rownames(poag\_r2))))

poag\_all<-rbind(poag\_r1,poag\_r2)



**# single-gene mendelian randomization study of POAG to IS**

exposure\_dat4 <- format\_data(

&nbsp; poag\_all,

&nbsp; type = "exposure",

&nbsp; snps = NULL,

&nbsp; header = TRUE,

&nbsp; snp\_col = "SNP",

&nbsp; beta\_col = "beta.exposure",

&nbsp; se\_col = "se.exposure",

&nbsp; eaf\_col = "eaf.exposure",

&nbsp; effect\_allele\_col = "effect\_allele.exposure",

&nbsp; other\_allele\_col = "other\_allele.exposure",

&nbsp; pval\_col = "pval.exposure",

&nbsp; samplesize\_col = "samplesize.exposure",

&nbsp; gene\_col = "GENE",

&nbsp; id\_col = "GENE",

&nbsp; min\_pval = 1e-310,

&nbsp; chr\_col = "chr.exposure",

&nbsp; pos\_col = "pos.exposure",

&nbsp; log\_pval = FALSE,phenotype\_col = 'id.exposure'

)

library(ieugwasr)

colnames(exposure\_dat4)\[7]<-'rsid'

colnames(exposure\_dat4)\[6]<-'pval'

colnames(exposure\_dat4)\[15]<-'id'

exposure\_dat4$id<-exposure\_dat4$gene.exposure

exposure\_dat5<-ld\_clump(

&nbsp;         dat = exposure\_dat4,

&nbsp;         clump\_kb = 100000,

&nbsp;         clump\_r2 = 0.001,

&nbsp;         pop = "EUR"

&nbsp;     )

exposure\_dat6<-exposure\_dat5

colnames(exposure\_dat6)\[7]<-'SNP'

colnames(exposure\_dat6)\[6]<-'pval.exposure'

colnames(exposure\_dat6)\[15]<-'exposure'

&nbsp;exposure\_dat6$exposure<-exposure\_dat6$gene.exposure

exposure\_dat6$id.exposure<-exposure\_dat6$exposure

chd\_out\_dat <- extract\_outcome\_data(

&nbsp;    snps = exposure\_dat6$SNP,

&nbsp;    outcomes = 'ebi-a-GCST006908',proxies = 1, rsq = 0.8, align\_alleles = 1, palindromes = 1, maf\_threshold = 0.3

&nbsp;)

dat <- harmonise\_data(

&nbsp;   exposure\_dat = exposure\_dat6, 

&nbsp;   outcome\_dat = chd\_out\_dat

)

poag\_genes\_is\_res <- mr(dat)



**#2.3 significant POAG SNPs mapped to genes**

iop<-extract\_instruments('ukb-b-14146',p1=5e-8,clump = FALSE,p2=1)

iop\_r1<-merge(iop,merge.data,by.x = c('chr.exposure','pos.exposure'),by.y = c('chr','pos'))

iop\_r2<-merge(iop,merge.data1,by.x = c('chr.exposure','pos.exposure'),by.y = c('chr','pos'))

iop\_r1<-data.frame(iop\_r1)

iop\_r2<-data.frame(iop\_r2)

iop\_r1<-iop\_r1\[,-c(16,17)]

colnames(iop\_r1)\[4]<-'SNP'

iop\_r1$samplesize.exposure<-c(rep(97653,length(rownames(iop\_r1))))

iop\_r2$samplesize.exposure<-c(rep(97653,length(rownames(iop\_r2))))

iop\_all<-rbind(iop\_r1,iop\_r2)



**# single-gene mendelian randomization study of IOP to IS**

exposure\_dat4 <- format\_data(

&nbsp; iop\_all,

&nbsp; type = "exposure",

&nbsp; snps = NULL,

&nbsp; header = TRUE,

&nbsp; snp\_col = "SNP",

&nbsp; beta\_col = "beta.exposure",

&nbsp; se\_col = "se.exposure",

&nbsp; eaf\_col = "eaf.exposure",

&nbsp; effect\_allele\_col = "effect\_allele.exposure",

&nbsp; other\_allele\_col = "other\_allele.exposure",

&nbsp; pval\_col = "pval.exposure",

&nbsp; samplesize\_col = "samplesize.exposure",

&nbsp; gene\_col = "genes",

&nbsp; id\_col = "id.exposure",

&nbsp; min\_pval = 1e-200,

&nbsp; chr\_col = "chr.exposure",

&nbsp; pos\_col = "pos.exposure",

&nbsp; log\_pval = FALSE,phenotype\_col = 'id.exposure'

)



colnames(exposure\_dat4)\[7]<-'rsid'

colnames(exposure\_dat4)\[5]<-'pval'

exposure\_dat5<-ld\_clump(

&nbsp;         dat = exposure\_dat4,

&nbsp;         clump\_kb = 10000,

&nbsp;         clump\_r2 = 0.001,

&nbsp;         pop = "EUR"

&nbsp;     )

colnames(exposure\_dat5)\[7]<-'SNP'

colnames(exposure\_dat5)\[5]<-'pval.exposure'

exposure\_dat6<-exposure\_dat5

chd\_out\_dat <- extract\_outcome\_data(

&nbsp;    snps = exposure\_dat6$SNP,

&nbsp;    outcomes = 'ebi-a-GCST006908',proxies = 1, rsq = 0.8, align\_alleles = 1, palindromes = 1, maf\_threshold = 0.3

&nbsp;)



dat <- harmonise\_data(

&nbsp;   exposure\_dat = exposure\_dat6, 

&nbsp;   outcome\_dat = chd\_out\_dat

)

iop\_is\_gene\_res <- mr(dat)



**# significant IOP SNPs mapped to genes**  

gene\_ukbb<-na.omit( merge.data1\[match(dat$SNP,merge.data1$SNP),])

merge.data1<-merge.data1\[,-c(9,10)]

gene\_1000eur<-na.omit( merge.data\[match(dat$SNP,merge.data$SNP),])

combine\_genes<-unique(c(gene\_1000eur$GENE,gene\_ukbb$GENE))





**# 2.3 GO and pathway analysis**

library(org.Hs.eg.db)

library(clusterProfiler)

library(data.table)

geneset1<- bitr(combine\_genes, fromType ="SYMBOL",

&nbsp;                toType = c("ENTREZID", "SYMBOL"),

&nbsp;                OrgDb = org.Hs.eg.db)



ego\_cc <- enrichGO(gene          =geneset1$ENTREZID,

&nbsp;                   OrgDb         = org.Hs.eg.db,

&nbsp;                   ont           = "CC",

&nbsp;                   pAdjustMethod = "BH",

&nbsp;                   pvalueCutoff  = 0.05,

&nbsp;                   qvalueCutoff  = 0.05,

&nbsp;                   readable      = TRUE)



ego\_bp <- enrichGO(gene          =geneset1$ENTREZID,

&nbsp;                   OrgDb         = org.Hs.eg.db,

&nbsp;                   ont           = "BP",

&nbsp;                   pAdjustMethod = "BH",

&nbsp;                   pvalueCutoff  = 0.05,

&nbsp;                   qvalueCutoff  = 0.05,

&nbsp;                   readable      = TRUE)



ego\_mf <- enrichGO(gene          =geneset1$ENTREZID,

&nbsp;                   OrgDb         = org.Hs.eg.db,

&nbsp;                   ont           = "MF",

&nbsp;                   pAdjustMethod = "BH",

&nbsp;                   pvalueCutoff  = 0.05,

&nbsp;                   qvalueCutoff  = 0.05,

&nbsp;                   readable      = TRUE)

dotplot(ego\_cc)

dotplot(ego\_bp)

dotplot(ego\_mf)



kk <- enrichKEGG(gene         = geneset1$ENTREZID,

&nbsp;                organism     = 'hsa',

&nbsp;                pvalueCutoff = 0.05)

dotplot(kk)

wp<-enrichWP(geneset1$ENTREZID, organism = "Homo sapiens") 





